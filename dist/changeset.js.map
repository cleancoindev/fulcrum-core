{"version":3,"sources":["../src/changeset.js"],"names":[],"mappings":"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","file":"changeset.js","sourcesContent":["import DateUtils from './utils/date-utils';\nimport { format } from 'util';\nimport _ from 'lodash';\n\nexport default class Changeset {\n  constructor(attributes) {\n    this.updateFromAPIAttributes(attributes);\n  }\n\n  updateFromAPIAttributes(attributes) {\n    attributes = attributes || {};\n\n    this._id = attributes.id;\n    this._metadata = attributes.metadata || {};\n    this._minLat = attributes.min_lat;\n    this._maxLat = attributes.max_lat;\n    this._minLon = attributes.min_lon;\n    this._maxLon = attributes.max_lon;\n    this._numberOfChanges = attributes.number_of_changes;\n    this._closedAt = DateUtils.parseISOTimestamp(attributes.closed_at);\n    this._closedBy = attributes.closed_by;\n    this._closedByID = attributes.closed_by_id;\n    this._createdAt = DateUtils.parseISOTimestamp(attributes.created_at);\n    this._createdBy = attributes.created_by;\n    this._createdByID = attributes.created_by_id;\n    this._updatedAt = DateUtils.parseISOTimestamp(attributes.updated_at);\n    this._updatedBy = attributes.updated_by;\n    this._updatedByID = attributes.updated_by_id;\n    this._formID = attributes.form_id;\n  }\n\n  toJSON() {\n    const json = {};\n\n    json.id = this._id;\n    json.metadata = this._metadata || {};\n\n    json.min_lat = this._minLat;\n    json.max_lat = this._maxLat;\n    json.min_lon = this._minLon;\n    json.max_lon = this._maxLon;\n\n    json.number_of_changes = this._numberOfChanges;\n\n    json.closed_at = DateUtils.formatISOTimestamp(this._closedAt);\n    json.closed_by = this._closedBy;\n    json.closed_by_id = this._closedByID;\n\n    json.created_at = DateUtils.formatISOTimestamp(this._createdAt);\n    json.created_by = this._createdBy;\n    json.created_by_id = this._createdByID;\n\n    json.updated_at = DateUtils.formatISOTimestamp(this._updatedAt);\n    json.updated_by = this._updatedBy;\n    json.updated_by_id = this._updatedByID;\n\n    json.form_id = this._formID;\n  }\n\n  get id() {\n    return this._id;\n  }\n\n  get isClosed() {\n    return this._closedAt != null;\n  }\n\n  get displayValue() {\n    return format('Submitted %s by %s from %s',\n                  this._createdAt,\n                  this._createdBy,\n                  this.metadataDescription);\n  }\n\n  get metadataDescription() {\n    const parts = [\n      this._metadata.application,\n      this._metadata.application_version,\n      this._metadata.browser,\n      this._metadata.browser_version,\n      this._metadata.platform,\n      this._metadata.platform_version,\n      this._metadata.device_manufacturer,\n      this._metadata.device_model\n    ];\n\n    return _.compact(parts).join(' / ');\n  }\n}\n"]}