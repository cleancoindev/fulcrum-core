{"version":3,"sources":["../../src/elements/choice-element.js"],"names":[],"mappings":"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","file":"choice-element.js","sourcesContent":["import Element from './element';\nimport ElementFactory from './element-factory';\nimport Choice from './choice';\n\nexport default class ChoiceElement extends Element {\n  constructor(parent, attributes) {\n    super(parent, attributes);\n\n    this.multiple = !!attributes.multiple;\n    this.allowOther = !!attributes.allow_other;\n    this.choiceFilter = null;\n    this.overrideChoices = null;\n\n    this._choiceListID = attributes.choice_list_id;\n    this._choices = [];\n\n    // TODO(zhm) the loading needs to be re-worked to support choice lists\n    if (attributes.choices) {\n      for (let choice of this.attributes.choices) {\n        this._choices.push(new Choice(choice));\n      }\n    }\n  }\n\n  async load() {\n    // TODO(zhm) once babel gets fixed this can be removed\n    // https://phabricator.babeljs.io/T2765\n\n    if (this._choiceListID) {\n      this.choiceList = await ElementFactory.getProvider().getChoiceList(this._choiceListID);\n      this._choices = this.choiceList.choices.slice();\n    } else {\n      for (let choice of this.attributes.choices) {\n        this._choices.push(new Choice(choice));\n      }\n    }\n\n    this._choicesByValue = null;\n  }\n\n  get isLengthValidationSupported() {\n    return this.multiple;\n  }\n\n  get choices() {\n    return this._overrideChoices ? this._overrideChoices : this.filteredChoices;\n  }\n\n  get filteredChoices() {\n    const items = this._choices;\n\n    if (!this.choiceFilter) {\n      return items;\n    }\n\n    const filteredItems = [];\n\n    for (let item of items) {\n      for (let filter of this.choiceFilter) {\n        if (item.value.toLowerCase().indexOf(filter.toLowerCase()) !== -1) {\n          filteredItems.push(item);\n        }\n      }\n    }\n\n    return filteredItems;\n  }\n\n  get overrideChoices() {\n    return this._overrideChoices;\n  }\n\n  set overrideChoices(overrideChoices) {\n    this._choicesByValue = null;\n\n    if (!overrideChoices || overrideChoices.length < 1) {\n      this._overrideChoices = null;\n      return;\n    }\n\n    const choices = [];\n\n    for (let choiceAttributes of overrideChoices) {\n      const choice = new Choice(choiceAttributes);\n\n      choices.push(choice);\n    }\n\n    this._overrideChoices = choices;\n  }\n\n  choiceByValue(value) {\n    if (!this._choicesByValue) {\n      this._choicesByValue = {};\n\n      for (let choice of this.choices) {\n        this._choicesByValue[choice.value] = choice;\n      }\n    }\n\n    return this._choicesByValue[value];\n  }\n}\n"]}