{"version":3,"sources":["../../src/elements/choice-element.js"],"names":[],"mappings":"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","file":"choice-element.js","sourcesContent":["import Element from './element';\nimport Choice from './choice';\n\nexport default class ChoiceElement extends Element {\n  constructor(parent, attributes) {\n    super(parent, attributes);\n\n    this.multiple = !!attributes.multiple;\n    this.allowOther = !!attributes.allow_other;\n\n    this._choiceFilter = null;\n    this._overrideChoices = null;\n\n    this._choiceListID = attributes.choice_list_id;\n    this._choices = [];\n\n    // TODO(zhm) the loading needs to be re-worked to support choice lists\n    if (attributes.choices) {\n      for (let choice of attributes.choices) {\n        this._choices.push(new Choice(choice));\n      }\n    }\n  }\n\n  load(dataSource, callback) {\n    this._choicesByValue = null;\n\n    if (this._choiceListID) {\n      dataSource.getChoiceList(this._choiceListID, (err, choiceList) => {\n        if (err) {\n          return callback(err);\n        }\n\n        this.choiceList = choiceList;\n        this._choices = this.choiceList.choices.slice();\n\n        return callback();\n      });\n    } else {\n      setImmediate(callback);\n    }\n  }\n\n  get isLengthValidationSupported() {\n    return this.multiple;\n  }\n\n  get choices() {\n    return this._overrideChoices ? this._overrideChoices : this.filteredChoices;\n  }\n\n  get choiceFilter() {\n    return this._choiceFilter;\n  }\n\n  set choiceFilter(choiceFilter) {\n    this._choiceFilter = choiceFilter;\n  }\n\n  get filteredChoices() {\n    const items = this._choices;\n\n    if (!this.choiceFilter) {\n      return items;\n    }\n\n    const filteredItems = [];\n\n    for (let item of items) {\n      for (let filter of this.choiceFilter) {\n        if (item.value.toLowerCase().indexOf(filter.toLowerCase()) !== -1) {\n          filteredItems.push(item);\n        }\n      }\n    }\n\n    return filteredItems;\n  }\n\n  get overrideChoices() {\n    return this._overrideChoices;\n  }\n\n  set overrideChoices(overrideChoices) {\n    this._choicesByValue = null;\n\n    if (!overrideChoices || overrideChoices.length < 1) {\n      this._overrideChoices = null;\n      return;\n    }\n\n    const choices = [];\n\n    for (let choiceAttributes of overrideChoices) {\n      const choice = new Choice(choiceAttributes);\n\n      choices.push(choice);\n    }\n\n    this._overrideChoices = choices;\n  }\n\n  get overrideValues() {\n    return Object.assign(super.overrideValues, {\n      choiceFilter: this._choiceFilter,\n      overrideChoices: this._overrideChoices\n    });\n  }\n\n  resetOverrides() {\n    super.resetOverrides();\n\n    this._choiceFilter = null;\n    this._overrideChoices = null;\n  }\n\n  choiceByValue(value) {\n    if (!this._choicesByValue) {\n      this._choicesByValue = {};\n\n      for (let choice of this.choices) {\n        this._choicesByValue[choice.value] = choice;\n      }\n    }\n\n    return this._choicesByValue[value];\n  }\n}\n"]}