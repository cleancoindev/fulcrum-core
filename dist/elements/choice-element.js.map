{"version":3,"sources":["../../src/elements/choice-element.js"],"names":[],"mappings":"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","file":"choice-element.js","sourcesContent":["import Element from './element';\nimport Choice from './choice';\n\nexport default class ChoiceElement extends Element {\n  constructor(parent, attributes) {\n    super(parent, attributes);\n\n    this.multiple = !!attributes.multiple;\n    this.allowOther = !!attributes.allow_other;\n    this.choiceFilter = null;\n    this.overrideChoices = null;\n\n    this._choiceListID = attributes.choice_list_id;\n    this._choices = [];\n\n    // TODO(zhm) the loading needs to be re-worked to support choice lists\n    if (attributes.choices) {\n      for (let choice of this.attributes.choices) {\n        this._choices.push(new Choice(choice));\n      }\n    }\n  }\n\n  load(dataSource, callback) {\n    this._choicesByValue = null;\n\n    if (this._choiceListID) {\n      dataSource.getChoiceList(this._choiceListID, (err, choiceList) => {\n        if (err) {\n          return callback(err);\n        }\n\n        this.choiceList = choiceList;\n        this._choices = this.choiceList.choices.slice();\n\n        return callback();\n      });\n    } else {\n      setImmediate(callback);\n    }\n  }\n\n  get isLengthValidationSupported() {\n    return this.multiple;\n  }\n\n  get choices() {\n    return this._overrideChoices ? this._overrideChoices : this.filteredChoices;\n  }\n\n  get filteredChoices() {\n    const items = this._choices;\n\n    if (!this.choiceFilter) {\n      return items;\n    }\n\n    const filteredItems = [];\n\n    for (let item of items) {\n      for (let filter of this.choiceFilter) {\n        if (item.value.toLowerCase().indexOf(filter.toLowerCase()) !== -1) {\n          filteredItems.push(item);\n        }\n      }\n    }\n\n    return filteredItems;\n  }\n\n  get overrideChoices() {\n    return this._overrideChoices;\n  }\n\n  set overrideChoices(overrideChoices) {\n    this._choicesByValue = null;\n\n    if (!overrideChoices || overrideChoices.length < 1) {\n      this._overrideChoices = null;\n      return;\n    }\n\n    const choices = [];\n\n    for (let choiceAttributes of overrideChoices) {\n      const choice = new Choice(choiceAttributes);\n\n      choices.push(choice);\n    }\n\n    this._overrideChoices = choices;\n  }\n\n  choiceByValue(value) {\n    if (!this._choicesByValue) {\n      this._choicesByValue = {};\n\n      for (let choice of this.choices) {\n        this._choicesByValue[choice.value] = choice;\n      }\n    }\n\n    return this._choicesByValue[value];\n  }\n}\n"]}