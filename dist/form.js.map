{"version":3,"sources":["../src/form.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAMqB;AACnB,WADmB,IACnB,CAAY,UAAZ,EAAwB;0BADL,MACK;;AACtB,iBAAa,cAAc,EAAd,CADS;;AAGtB,SAAK,GAAL,GAAW,WAAW,EAAX;;;AAHW,QAMtB,CAAK,KAAL,GAAa,UAAb;;AANsB,QAQtB,CAAK,cAAL,GAAsB,WAAW,gBAAX,IAA+B,CAAC,WAAW,gBAAX,CAAhC,CARA;AAStB,SAAK,MAAL,GAAc,WAAW,MAAX,CATQ;AAUtB,SAAK,mBAAL,CAAyB,WAAW,QAAX,CAAzB,CAVsB;;AAYtB,SAAK,gBAAL,GAAwB,WAAW,YAAX,CAZF;AAatB,SAAK,YAAL,GAAoB,IAApB,CAbsB;;AAetB,SAAK,KAAL,GAAa,WAAW,IAAX,CAfS;AAgBtB,SAAK,iBAAL,GAAyB,CAAC,CAAC,WAAW,iBAAX,CAhBL;GAAxB;;AADmB,iBAwBnB,qBAAK,YAAY,UAAU;AACzB,QAAM,eAAe,EAAf,CADmB;;AAGzB,yBAAsB,KAAK,WAAL,8GAAtB,IAAwC;;;;;;;;;;;;UAA7B,eAA6B;;AACtC,UAAI,QAAQ,IAAR,EAAc;AAChB,qBAAa,IAAb,CAAkB,OAAlB,EADgB;OAAlB;KADF;;AAMA,oBAAM,IAAN,CAAW,YAAX,EAAyB,UAAC,OAAD,EAAU,EAAV,EAAiB;AACxC,cAAQ,IAAR,CAAa,UAAb,EAAyB,EAAzB,EADwC;KAAjB,EAEtB,QAFH,EATyB;;;AAxBR,iBAsCnB,qCAAa,YAAY;AACvB,QAAM,SAAS,qBAAW,UAAX,EAAuB,IAAvB,CAAT,CADiB;;AAGvB,4BAAc,6BAAd,CAA4C,KAAK,QAAL,EACA,OAAO,UAAP,EACA,MAF5C,EAHuB;;AAOvB,WAAO,MAAP,CAPuB;;;AAtCN,iBAuDnB,mBAAI,KAAK;AACP,WAAO,KAAK,aAAL,CAAmB,GAAnB,CAAP,CADO;;;AAvDU,iBA2DnB,qBAAK,UAAU;AACb,WAAO,KAAK,kBAAL,CAAwB,QAAxB,CAAP,CADa;;;AA3DI,iBAmEnB,2BAAS;;AAEP,WAAO,KAAK,KAAL,CAFA;;;eAnEU;;wBAoBV;AACP,aAAO,KAAK,GAAL,CADA;;;;wBA4BS;AAChB,UAAI,CAAC,KAAK,YAAL,EAAmB;AACtB,aAAK,YAAL,GAAoB,4BAAkB,IAAlB,EAAwB,KAAK,gBAAL,CAA5C,CADsB;OAAxB;AAGA,aAAO,KAAK,YAAL,CAJS;;;;wBAeI;AACpB,aAAO,KAAP,CADoB;;;;wBASG;AACvB,aAAO,KAAK,iBAAL,CADgB;;;;wBAId;AACT,aAAO,KAAK,KAAL,CADE;;;;SA5EQ;;;;;;AAiFrB,wBAAc,WAAd,CAA0B,IAA1B","file":"form.js","sourcesContent":["import ChildElements from './elements/child-elements';\nimport StatusElement from './elements/status-element';\nimport DefaultValues from './values/default-values';\nimport Record from './record';\nimport async from 'async';\n\nexport default class Form {\n  constructor(attributes) {\n    attributes = attributes || {};\n\n    this._id = attributes.id;\n\n    // TODO(zhm) remove json attr\n    this._json = attributes;\n    // TODO(zhm) this might need to go away\n    this.titleFieldKeys = attributes.title_field_keys || [attributes.record_title_key];\n    this.script = attributes.script;\n    this.createChildElements(attributes.elements);\n\n    this._statusFieldJSON = attributes.status_field;\n    this._statusField = null;\n\n    this._name = attributes.name;\n    this._geometryRequired = !!attributes.geometry_required;\n  }\n\n  get id() {\n    return this._id;\n  }\n\n  load(dataSource, callback) {\n    const loadElements = [];\n\n    for (const element of this.allElements) {\n      if (element.load) {\n        loadElements.push(element);\n      }\n    }\n\n    async.each(loadElements, (element, cb) => {\n      element.load(dataSource, cb);\n    }, callback);\n  }\n\n  createRecord(attributes) {\n    const record = new Record(attributes, this);\n\n    DefaultValues.applyDefaultValuesForElements(this.elements,\n                                                record.formValues,\n                                                record);\n\n    return record;\n  }\n\n  get statusField() {\n    if (!this._statusField) {\n      this._statusField = new StatusElement(this, this._statusFieldJSON);\n    }\n    return this._statusField;\n  }\n\n  get(key) {\n    return this.elementsByKey[key];\n  }\n\n  find(dataName) {\n    return this.elementsByDataName[dataName];\n  }\n\n  get hasHiddenParent() {\n    return false;\n  }\n\n  toJSON() {\n    // TODO(zhm) actually implement this so it returns a copy\n    return this._json;\n  }\n\n  get isGeometryRequired() {\n    return this._geometryRequired;\n  }\n\n  get name() {\n    return this._name;\n  }\n}\n\nChildElements.includeInto(Form);\n"]}