{"version":3,"sources":["../src/form.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAMqB;AACnB,WADmB,IACnB,CAAY,UAAZ,EAAwB;0BADL,MACK;;;AAEtB,SAAK,KAAL,GAAa,UAAb;;AAFsB,QAItB,CAAK,cAAL,GAAsB,WAAW,gBAAX,CAJA;AAKtB,SAAK,MAAL,GAAc,WAAW,MAAX,CALQ;AAMtB,SAAK,mBAAL,CAAyB,WAAW,QAAX,CAAzB,CANsB;;AAQtB,SAAK,gBAAL,GAAwB,WAAW,YAAX,CARF;AAStB,SAAK,YAAL,GAAoB,IAApB,CATsB;;AAWtB,SAAK,KAAL,GAAa,WAAW,IAAX,CAXS;AAYtB,SAAK,iBAAL,GAAyB,CAAC,CAAC,WAAW,iBAAX,CAZL;GAAxB;;AADmB,iBAgBnB,qBAAK,YAAY,UAAU;AACzB,QAAM,eAAe,EAAf,CADmB;;AAGzB,yBAAsB,KAAK,WAAL,8GAAtB,IAAwC;;;;;;;;;;;;UAA7B,eAA6B;;AACtC,UAAI,QAAQ,IAAR,EAAc;AAChB,qBAAa,IAAb,CAAkB,OAAlB,EADgB;OAAlB;KADF;;AAMA,oBAAM,IAAN,CAAW,YAAX,EAAyB,UAAC,OAAD,EAAU,EAAV,EAAiB;AACxC,cAAQ,IAAR,CAAa,UAAb,EAAyB,EAAzB,EADwC;KAAjB,EAEtB,QAFH,EATyB;;;AAhBR,iBA8BnB,qCAAa,YAAY;AACvB,QAAM,SAAS,qBAAW,UAAX,EAAuB,IAAvB,CAAT;;;AADiB,UAIvB,CAAO,KAAP,GAAe,IAAf,CAJuB;AAKvB,WAAO,eAAP,GAAyB,EAAzB,CALuB;;AAOvB,4BAAc,6BAAd,CAA4C,KAAK,QAAL,EACA,OAAO,UAAP,EACA,MAF5C,EAPuB;;AAWvB,WAAO,MAAP,CAXuB;;;AA9BN,iBAmDnB,mBAAI,KAAK;AACP,WAAO,KAAK,aAAL,CAAmB,GAAnB,CAAP,CADO;;;AAnDU,iBAuDnB,qBAAK,UAAU;AACb,WAAO,KAAK,kBAAL,CAAwB,QAAxB,CAAP,CADa;;;AAvDI,iBA+DnB,2BAAS;;AAEP,WAAO,KAAK,KAAL,CAFA;;;eA/DU;;wBA4CD;AAChB,UAAI,CAAC,KAAK,YAAL,EAAmB;AACtB,aAAK,YAAL,GAAoB,4BAAkB,IAAlB,EAAwB,KAAK,gBAAL,CAA5C,CADsB;OAAxB;AAGA,aAAO,KAAK,YAAL,CAJS;;;;wBAeI;AACpB,aAAO,KAAP,CADoB;;;;wBASG;AACvB,aAAO,KAAK,iBAAL,CADgB;;;;wBAId;AACT,aAAO,KAAK,KAAL,CADE;;;;SAxEQ;;;;;;AA6ErB,wBAAc,WAAd,CAA0B,IAA1B","file":"form.js","sourcesContent":["import ChildElements from './elements/child-elements';\nimport StatusElement from './elements/status-element';\nimport DefaultValues from './values/default-values';\nimport Record from './record';\nimport async from 'async';\n\nexport default class Form {\n  constructor(attributes) {\n    // TODO(zhm) remove json attr\n    this._json = attributes;\n    // TODO(zhm) this might need to go away\n    this.titleFieldKeys = attributes.title_field_keys;\n    this.script = attributes.script;\n    this.createChildElements(attributes.elements);\n\n    this._statusFieldJSON = attributes.status_field;\n    this._statusField = null;\n\n    this._name = attributes.name;\n    this._geometryRequired = !!attributes.geometry_required;\n  }\n\n  load(dataSource, callback) {\n    const loadElements = [];\n\n    for (const element of this.allElements) {\n      if (element.load) {\n        loadElements.push(element);\n      }\n    }\n\n    async.each(loadElements, (element, cb) => {\n      element.load(dataSource, cb);\n    }, callback);\n  }\n\n  createRecord(attributes) {\n    const record = new Record(attributes, this);\n\n    // TODO(zhm) this might not be final\n    record._form = this;\n    record._formValuesJSON = {};\n\n    DefaultValues.applyDefaultValuesForElements(this.elements,\n                                                record.formValues,\n                                                record);\n\n    return record;\n  }\n\n  get statusField() {\n    if (!this._statusField) {\n      this._statusField = new StatusElement(this, this._statusFieldJSON);\n    }\n    return this._statusField;\n  }\n\n  get(key) {\n    return this.elementsByKey[key];\n  }\n\n  find(dataName) {\n    return this.elementsByDataName[dataName];\n  }\n\n  get hasHiddenParent() {\n    return false;\n  }\n\n  toJSON() {\n    // TODO(zhm) actually implement this so it returns a copy\n    return this._json;\n  }\n\n  get isGeometryRequired() {\n    return this._geometryRequired;\n  }\n\n  get name() {\n    return this._name;\n  }\n}\n\nChildElements.includeInto(Form);\n"]}