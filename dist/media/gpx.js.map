{"version":3,"sources":["../../src/media/gpx.js"],"names":["GPX","render","tracks","gpx","push","gpxStart","gpxTracks","gpxEnd","join","trim","timestamp","t","Date","toISOString","map","track","segments","length","gpxTrackStart","gpxTrackSegments","gpxTrackEnd","filter","o","segment","gpxTrackSegmentStart","gpxTrackPoints","gpxTrackSegmentEnd","locations","point","gpxTrackPoint","latitude","longitude","altitude","time","id"],"mappings":";;;;;;IAAqBA,G;;;;;MACZC,M,mBAAOC,M,EAAQ;AACpB,WAAO,IAAIF,GAAJ,GAAUC,MAAV,CAAiBC,MAAjB,CAAP;AACD,G;;gBAEDD,M,mBAAOC,M,EAAQ;AACb,QAAMC,MAAM,EAAZ;;AAEAA,QAAIC,IAAJ,CAAS,KAAKC,QAAL,EAAT;AACAF,QAAIC,IAAJ,CAAS,KAAKE,SAAL,CAAeJ,MAAf,CAAT;AACAC,QAAIC,IAAJ,CAAS,KAAKG,MAAL,EAAT;;AAEA,WAAOJ,IAAIK,IAAJ,CAAS,IAAT,EAAeC,IAAf,EAAP;AACD,G;;gBAEDC,S,sBAAUC,C,EAAG;AACX,WAAO,IAAIC,IAAJ,CAAS,CAACD,CAAV,EAAaE,WAAb,EAAP;AACD,G;;gBAEDR,Q,uBAAW;AACT;AAeD,G;;gBAEDC,S,sBAAUJ,M,EAAQ;AAAA;;AAChB,WAAOA,OAAOY,GAAP,CAAW,UAACC,KAAD,EAAW;AAC3B,UAAIA,MAAMC,QAAN,CAAeC,MAAnB,EAA2B;AACzB,YAAMd,MAAM,EAAZ;;AAEAA,YAAIC,IAAJ,CAAS,MAAKc,aAAL,CAAmBH,KAAnB,CAAT;AACAZ,YAAIC,IAAJ,CAAS,MAAKe,gBAAL,CAAsBJ,KAAtB,CAAT;AACAZ,YAAIC,IAAJ,CAAS,MAAKgB,WAAL,CAAiBL,KAAjB,CAAT;;AAEA,eAAOZ,IAAIK,IAAJ,CAAS,IAAT,CAAP;AACD;;AAED,aAAO,IAAP;AACD,KAZM,EAYJa,MAZI,CAYG;AAAA,aAAKC,CAAL;AAAA,KAZH,EAYWd,IAZX,CAYgB,IAZhB,CAAP;AAaD,G;;gBAEDW,gB,6BAAiBJ,K,EAAO;AAAA;;AACtB,WAAOA,MAAMC,QAAN,CAAeF,GAAf,CAAmB,UAACS,OAAD,EAAa;AACrC,UAAMpB,MAAM,EAAZ;;AAEAA,UAAIC,IAAJ,CAAS,OAAKoB,oBAAL,CAA0BT,KAA1B,CAAT;AACAZ,UAAIC,IAAJ,CAAS,OAAKqB,cAAL,CAAoBF,OAApB,CAAT;AACApB,UAAIC,IAAJ,CAAS,OAAKsB,kBAAL,EAAT;;AAEA,aAAOvB,IAAIK,IAAJ,CAAS,IAAT,CAAP;AACD,KARM,CAAP;AASD,G;;gBAEDiB,c,2BAAeV,K,EAAO;AAAA;;AACpB,WAAOA,MAAMY,SAAN,CAAgBb,GAAhB,CAAoB,UAACc,KAAD,EAAW;AACpC,aAAO,OAAKC,aAAL,CAAmBD,KAAnB,CAAP;AACD,KAFM,EAEJpB,IAFI,CAEC,IAFD,CAAP;AAGD,G;;gBAEDqB,a,0BAAcD,K,EAAO;AACnB,8BACUA,MAAME,QADhB,eACkCF,MAAMG,SADxC,iBAEGH,MAAMI,QAFT,sBAGI,KAAKtB,SAAL,CAAekB,MAAMK,IAArB,CAHJ;AAMD,G;;gBAEDf,a,0BAAcH,K,EAAO;AACnB,iCAEMA,MAAMmB,EAFZ;AAID,G;;gBAEDV,oB,mCAAuB;AACrB,WAAO,UAAP;AACD,G;;gBAEDE,kB,iCAAqB;AACnB,WAAO,WAAP;AACD,G;;gBAEDN,W,0BAAc;AACZ,WAAO,QAAP;AACD,G;;gBAEDb,M,qBAAS;AACP,WAAO,QAAP;AACD,G;;;;;kBArGkBP,G","file":"gpx.js","sourcesContent":["export default class GPX {\n  static render(tracks) {\n    return new GPX().render(tracks);\n  }\n\n  render(tracks) {\n    const gpx = [];\n\n    gpx.push(this.gpxStart());\n    gpx.push(this.gpxTracks(tracks));\n    gpx.push(this.gpxEnd());\n\n    return gpx.join('\\n').trim();\n  }\n\n  timestamp(t) {\n    return new Date(+t).toISOString();\n  }\n\n  gpxStart() {\n    return `\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\" ?>\n<gpx xmlns=\"http://www.topografix.com/GPX/1/1\"\n     xmlns:gpxx=\"http://www.garmin.com/xmlschemas/GpxExtensions/v3\"\n     xmlns:gpxtpx=\"http://www.garmin.com/xmlschemas/TrackPointExtension/v1\"\n     xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n     xsi:schemaLocation=\"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd http://www.garmin.com/xmlschemas/GpxExtensions/v3 http://www.garmin.com/xmlschemas/GpxExtensionsv3.xsd http://www.garmin.com/xmlschemas/TrackPointExtension/v1 http://www.garmin.com/xmlschemas/TrackPointExtensionv1.xsd\"\n     creator=\"Fulcrum\"\n     version=\"1.1\">\n<metadata>\n  <link href=\"http://fulcrumapp.com\">\n    <text>Fulcrum</text>\n  </link>\n</metadata>\n`;\n  }\n\n  gpxTracks(tracks) {\n    return tracks.map((track) => {\n      if (track.segments.length) {\n        const gpx = [];\n\n        gpx.push(this.gpxTrackStart(track));\n        gpx.push(this.gpxTrackSegments(track));\n        gpx.push(this.gpxTrackEnd(track));\n\n        return gpx.join('\\n');\n      }\n\n      return null;\n    }).filter(o => o).join('\\n');\n  }\n\n  gpxTrackSegments(track) {\n    return track.segments.map((segment) => {\n      const gpx = [];\n\n      gpx.push(this.gpxTrackSegmentStart(track));\n      gpx.push(this.gpxTrackPoints(segment));\n      gpx.push(this.gpxTrackSegmentEnd());\n\n      return gpx.join('\\n');\n    });\n  }\n\n  gpxTrackPoints(track) {\n    return track.locations.map((point) => {\n      return this.gpxTrackPoint(point);\n    }).join('\\n');\n  }\n\n  gpxTrackPoint(point) {\n    return `\n<trkpt lat=\"${point.latitude}\" lon=\"${point.longitude}\">\n<ele>${point.altitude}</ele>\n<time>${this.timestamp(point.time)}</time>\n</trkpt>\n`;\n  }\n\n  gpxTrackStart(track) {\n    return `\n<trk>\n  <name>${track.id}</name>\n`;\n  }\n\n  gpxTrackSegmentStart() {\n    return '<trkseg>';\n  }\n\n  gpxTrackSegmentEnd() {\n    return '</trkseg>';\n  }\n\n  gpxTrackEnd() {\n    return '</trk>';\n  }\n\n  gpxEnd() {\n    return '</gpx>';\n  }\n}\n"]}