{"version":3,"sources":["../src/record.js"],"names":["Record","attributes","form","_form","updateFromAPIAttributes","loadChangeset","dataSource","callback","toJSON","simple","json","form_id","id","version","_version","created_at","DateUtils","formatISOTimestamp","createdAt","updated_at","updatedAt","client_created_at","clientCreatedAt","client_updated_at","clientUpdatedAt","form_values","formValues","toSimpleJSON","latitude","_latitude","longitude","_longitude","project_id","_projectID","assigned_to_id","_assignedToID","status","_status","created_by_id","_createdByID","created_by","_createdByName","updated_by_id","_updatedByID","updated_by","_updatedBy","_horizontalAccuracy","horizontal_accuracy","_verticalAccuracy","vertical_accuracy","_altitude","altitude","_speed","speed","_course","course","_changesetID","changeset_id","created_location","createdLocation","updated_location","updatedLocation","created_duration","createdDuration","updated_duration","updatedDuration","edited_duration","editedDuration","attrs","_id","uuid","v4","_createdAt","parseISOTimestamp","_updatedAt","_clientCreatedAt","_clientUpdatedAt","_formValuesJSON","_projectName","project","_assignedToName","assigned_to","_updatedByName","_createdDuration","_updatedDuration","_editedDuration","_createdLatitude","created_latitude","_createdLongitude","created_longitude","_createdAltitude","created_altitude","_createdAccuracy","created_horizontal_accuracy","_updatedLatitude","updated_latitude","_updatedLongitude","updated_longitude","_updatedAltitude","updated_altitude","_updatedAccuracy","updated_horizontal_accuracy","updateTimestamps","now","Date","get","key","statusValue","set","value","textValue","updateFromActionAttributes","role","Object","keys","dataName","canChangeProject","projectID","canAssignRecords","assignedToID","canChangeStatus","element","elementsByDataName","formValue","createValueFromString","_formValues","FormValues","_changeset","changeset","isGeometryEnabled","StatusValue","statusField","searchableValue","titleFieldKeys","titles","fieldKey","displayValue","TextUtils","isPresent","push","join","choices","length","isHidden","isReadOnly","isEnabled","name","user","fullName","_createdBy","accuracy","hasCoordinate","type","coordinates","createdLatitude","createdLongitude","updatedLatitude","updatedLongitude","hasCreatedCoordinate","createdAltitude","createdAccuracy","hasUpdatedCoordinate","updatedAltitude","updatedAccuracy","Feature"],"mappings":"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","file":"record.js","sourcesContent":["import Feature from './feature';\nimport FormValues from './values/form-values';\nimport TextUtils from './utils/text-utils';\nimport DateUtils from './utils/date-utils';\nimport StatusValue from './values/status-value';\nimport uuid from 'uuid';\nimport loadObject from './load-object';\n\nexport default class Record extends Feature {\n  constructor(attributes, form) {\n    super();\n\n    this._form = form || null;\n\n    this.updateFromAPIAttributes(attributes);\n  }\n\n  get isRecord() {\n    return true;\n  }\n\n  get isRepeatable() {\n    return false;\n  }\n\n  get id() {\n    return this._id;\n  }\n\n  set id(id) {\n    this._id = id;\n  }\n\n  get form() {\n    return this._form;\n  }\n\n  get version() {\n    return this._version;\n  }\n\n  get createdAt() {\n    return this._createdAt;\n  }\n\n  set createdAt(createdAt) {\n    this._createdAt = createdAt;\n  }\n\n  get updatedAt() {\n    return this._updatedAt;\n  }\n\n  set updatedAt(updatedAt) {\n    this._updatedAt = updatedAt;\n  }\n\n  get clientCreatedAt() {\n    return this._clientCreatedAt;\n  }\n\n  set clientCreatedAt(createdAt) {\n    this._clientCreatedAt = createdAt;\n  }\n\n  get clientUpdatedAt() {\n    return this._clientUpdatedAt;\n  }\n\n  set clientUpdatedAt(updatedAt) {\n    this._clientUpdatedAt = updatedAt;\n  }\n\n  get formValues() {\n    if (this._formValues == null) {\n      this._formValues = new FormValues(this._form, this._formValuesJSON);\n    }\n\n    return this._formValues;\n  }\n\n  get hasCoordinate() {\n    return this._latitude != null && this._longitude != null;\n  }\n\n  get changeset() {\n    return this._changeset;\n  }\n\n  set changeset(changeset) {\n    this._changesetID = changeset.id;\n    this._changeset = changeset;\n  }\n\n  get changesetID() {\n    return this._changesetID;\n  }\n\n  loadChangeset(dataSource, callback) {\n    return loadObject(this, dataSource, 'changeset', 'getChangeset', callback);\n  }\n\n  toJSON({simple} = {}) {\n    const json = {};\n\n    json.form_id = this._form.id;\n\n    json.id = this.id || null;\n    json.version = this._version != null ? this._version : null;\n    json.created_at = DateUtils.formatISOTimestamp(this.createdAt);\n    json.updated_at = DateUtils.formatISOTimestamp(this.updatedAt);\n    json.client_created_at = DateUtils.formatISOTimestamp(this.clientCreatedAt);\n    json.client_updated_at = DateUtils.formatISOTimestamp(this.clientUpdatedAt);\n    json.form_values = simple ? this.formValues.toSimpleJSON() : this.formValues.toJSON();\n    json.latitude = this._latitude != null ? this._latitude : null;\n    json.longitude = this._longitude != null ? this._longitude : null;\n    json.project_id = this._projectID || null;\n    json.assigned_to_id = this._assignedToID || null;\n    json.status = this._status || null;\n\n    json.created_by_id = this._createdByID || null;\n    json.created_by = this._createdByName || null;\n    json.updated_by_id = this._updatedByID || null;\n    json.updated_by = this._updatedBy || null;\n\n    if (this._horizontalAccuracy != null) {\n      json.horizontal_accuracy = this._horizontalAccuracy;\n    }\n\n    if (this._verticalAccuracy != null) {\n      json.vertical_accuracy = this._verticalAccuracy;\n    }\n\n    if (this._altitude != null) {\n      json.altitude = this._altitude;\n    }\n\n    if (this._speed != null) {\n      json.speed = this._speed;\n    }\n\n    if (this._course != null) {\n      json.course = this._course;\n    }\n\n    if (this._changesetID) {\n      json.changeset_id = this._changesetID;\n    }\n\n    json.created_location = this.createdLocation;\n    json.updated_location = this.updatedLocation;\n\n    json.created_duration = this.createdDuration;\n    json.updated_duration = this.updatedDuration;\n    json.edited_duration = this.editedDuration;\n\n    return json;\n  }\n\n  updateFromAPIAttributes(attrs) {\n    const attributes = attrs || {};\n\n    this._id = attributes.id || uuid.v4();\n    this._version = attributes.version != null ? attributes.version : null;\n    this._createdAt = DateUtils.parseISOTimestamp(attributes.created_at);\n    this._updatedAt = DateUtils.parseISOTimestamp(attributes.updated_at);\n    this._clientCreatedAt = DateUtils.parseISOTimestamp(attributes.client_created_at);\n    this._clientUpdatedAt = DateUtils.parseISOTimestamp(attributes.client_updated_at);\n    this._formValuesJSON = attributes.form_values || {};\n    this._latitude = attributes.latitude != null ? attributes.latitude : null;\n    this._longitude = attributes.longitude != null ? attributes.longitude : null;\n    this._projectID = attributes.project_id || null;\n    this._projectName = attributes.project || null;\n    this._assignedToID = attributes.assigned_to_id || null;\n    this._assignedToName = attributes.assigned_to || null;\n    this._status = attributes.status || null;\n\n    this._createdByID = attributes.created_by_id || null;\n    this._createdByName = attributes.created_by || null;\n    this._updatedByID = attributes.updated_by_id || null;\n    this._updatedByName = attributes.updated_by || null;\n\n    this._horizontalAccuracy = attributes.horizontal_accuracy != null ? attributes.horizontal_accuracy : null;\n    this._verticalAccuracy = attributes.vertical_accuracy != null ? attributes.vertical_accuracy : null;\n    this._altitude = attributes.altitude != null ? attributes.altitude : null;\n    this._speed = attributes.speed != null ? attributes.speed : null;\n    this._course = attributes.course != null ? attributes.course : null;\n\n    this._changesetID = attributes.changeset_id || null;\n\n    this._createdDuration = attributes.created_duration != null ? attributes.created_duration : null;\n    this._updatedDuration = attributes.updated_duration != null ? attributes.updated_duration : null;\n    this._editedDuration = attributes.edited_duration != null ? attributes.edited_duration : null;\n\n    const createdLocation = attributes.created_location;\n\n    this._createdLatitude = attributes.created_latitude != null ? attributes.created_latitude : null;\n    this._createdLongitude = attributes.created_longitude != null ? attributes.created_longitude : null;\n    this._createdAltitude = attributes.created_altitude != null ? attributes.created_altitude : null;\n    this._createdAccuracy = attributes.created_horizontal_accuracy != null ? attributes.created_horizontal_accuracy : null;\n\n    if (createdLocation) {\n      this._createdLatitude = createdLocation.latitude;\n      this._createdLongitude = createdLocation.longitude;\n      this._createdAltitude = createdLocation.altitude;\n      this._createdAccuracy = createdLocation.horizontal_accuracy;\n    }\n\n    const updatedLocation = attributes.updated_location;\n\n    this._updatedLatitude = attributes.updated_latitude != null ? attributes.updated_latitude : null;\n    this._updatedLongitude = attributes.updated_longitude != null ? attributes.updated_longitude : null;\n    this._updatedAltitude = attributes.updated_altitude != null ? attributes.updated_altitude : null;\n    this._updatedAccuracy = attributes.updated_horizontal_accuracy != null ? attributes.updated_horizontal_accuracy : null;\n\n    if (updatedLocation) {\n      this._updatedLatitude = updatedLocation.latitude;\n      this._updatedLongitude = updatedLocation.longitude;\n      this._updatedAltitude = updatedLocation.altitude;\n      this._updatedAccuracy = updatedLocation.horizontal_accuracy;\n    }\n  }\n\n  updateTimestamps() {\n    const now = new Date();\n\n    if (this.clientCreatedAt == null) {\n      this.clientCreatedAt = now;\n    }\n\n    this.clientUpdatedAt = now;\n  }\n\n  get isGeometryEnabled() {\n    return this.form.isGeometryEnabled;\n  }\n\n  get(key, formValues) {\n    if (key === '@status') {\n      return this.statusValue;\n    }\n\n    return formValues.get(key);\n  }\n\n  set(key, value, formValues) {\n    if (key === '@status') {\n      this.status = value.textValue;\n      return;\n    }\n\n    formValues.set(key, value);\n  }\n\n  get statusValue() {\n    return new StatusValue(this.form.statusField, this.status);\n  }\n\n  get searchableValue() {\n    return this.formValues.searchableValue;\n  }\n\n  get displayValue() {\n    const titleFieldKeys = this.form.titleFieldKeys;\n    const titles = [];\n\n    for (const fieldKey of titleFieldKeys) {\n      const value = this.formValues.get(fieldKey);\n\n      if (value) {\n        const displayValue = value.displayValue;\n\n        if (TextUtils.isPresent(displayValue)) {\n          titles.push(displayValue);\n        }\n      }\n    }\n\n    return titles.join(', ');\n  }\n\n  get isStatusFieldEnabled() {\n    // invisible if there are no statuses or the status field is marked as hidden\n    if (this.form.statusField.choices.length === 0 || this.form.statusField.isHidden) {\n      return false;\n    }\n\n    // invisible if it's readonly and there's no status (nothing for the user to read)\n    if (this.status == null && this.form.statusField.isReadOnly) {\n      return false;\n    }\n\n    return this.form.statusField.isEnabled;\n  }\n\n  get formID() {\n    return this.form ? this.form.id : null;\n  }\n\n  get projectName() {\n    return this._projectName;\n  }\n\n  get projectID() {\n    return this._projectID;\n  }\n\n  set projectID(id) {\n    if (id !== this._projectID) {\n      this._projectID = id;\n      this._projectName = null;\n    }\n  }\n\n  set project(project) {\n    if (project) {\n      this._projectID = project.id;\n      this._projectName = project.name;\n    } else {\n      this._projectID = null;\n      this._projectName = null;\n    }\n  }\n\n  get assignedToName() {\n    return this._assignedToName;\n  }\n\n  get assignedToID() {\n    return this._assignedToID;\n  }\n\n  set assignedTo(user) {\n    if (user) {\n      this._assignedToID = user.id;\n      this._assignedToName = user.fullName;\n    } else {\n      this._assignedToID = null;\n      this._assignedToName = null;\n    }\n  }\n\n  set assignedToID(id) {\n    if (id !== this._assignedToID) {\n      this._assignedToID = id;\n      this._assignedToName = null;\n    }\n  }\n\n  get createdBy() {\n    return this._createdBy;\n  }\n\n  get createdByID() {\n    return this._createdByID;\n  }\n\n  get createdByName() {\n    return this._createdByName;\n  }\n\n  get updatedBy() {\n    return this._updatedBy;\n  }\n\n  get updatedByID() {\n    return this._updatedByID;\n  }\n\n  get updatedByName() {\n    return this._updatedByName;\n  }\n\n  get status() {\n    return this._status;\n  }\n\n  set status(status) {\n    this._status = status;\n  }\n\n  get latitude() {\n    return this._latitude;\n  }\n\n  set latitude(latitude) {\n    this._latitude = latitude;\n  }\n\n  get longitude() {\n    return this._longitude;\n  }\n\n  set longitude(longitude) {\n    this._longitude = longitude;\n  }\n\n  get horizontalAccuracy() {\n    return this._horizontalAccuracy;\n  }\n\n  set horizontalAccuracy(accuracy) {\n    this._horizontalAccuracy = accuracy;\n  }\n\n  get verticalAccuracy() {\n    return this._verticalAccuracy;\n  }\n\n  set verticalAccuracy(accuracy) {\n    this._verticalAccuracy = accuracy;\n  }\n\n  get altitude() {\n    return this._altitude;\n  }\n\n  set altitude(altitude) {\n    this._altitude = altitude;\n  }\n\n  get speed() {\n    return this._speed;\n  }\n\n  set speed(speed) {\n    this._speed = speed;\n  }\n\n  get course() {\n    return this._course;\n  }\n\n  set course(course) {\n    this._course = course;\n  }\n\n  get geometryAsGeoJSON() {\n    if (!this.hasCoordinate) {\n      return null;\n    }\n\n    return {\n      type: 'Point',\n      coordinates: [\n        this.longitude,\n        this.latitude\n      ]\n    };\n  }\n\n  get createdDuration() {\n    return this._createdDuration;\n  }\n\n  set createdDuration(value) {\n    this._createdDuration = (value != null ? +value : null);\n  }\n\n  get updatedDuration() {\n    return this._updatedDuration;\n  }\n\n  set updatedDuration(value) {\n    this._updatedDuration = (value != null ? +value : null);\n  }\n\n  get editedDuration() {\n    return this._editedDuration;\n  }\n\n  set editedDuration(value) {\n    this._editedDuration = (value != null ? +value : null);\n  }\n\n  get createdLatitude() {\n    return this._createdLatitude;\n  }\n\n  get createdLongitude() {\n    return this._createdLongitude;\n  }\n\n  get createdAltitude() {\n    return this._createdAltitude;\n  }\n\n  get createdAccuracy() {\n    return this._createdAccuracy;\n  }\n\n  set createdLatitude(value) {\n    this._createdLatitude = (value != null ? +value : null);\n  }\n\n  set createdLongitude(value) {\n    this._createdLongitude = (value != null ? +value : null);\n  }\n\n  set createdAltitude(value) {\n    this._createdAltitude = (value != null ? +value : null);\n  }\n\n  set createdAccuracy(value) {\n    this._createdAccuracy = (value != null ? +value : null);\n  }\n\n  get updatedLatitude() {\n    return this._updatedLatitude;\n  }\n\n  get updatedLongitude() {\n    return this._updatedLongitude;\n  }\n\n  get updatedAltitude() {\n    return this._updatedAltitude;\n  }\n\n  get updatedAccuracy() {\n    return this._updatedAccuracy;\n  }\n\n  set updatedLatitude(value) {\n    this._updatedLatitude = (value != null ? +value : null);\n  }\n\n  set updatedLongitude(value) {\n    this._updatedLongitude = (value != null ? +value : null);\n  }\n\n  set updatedAltitude(value) {\n    this._updatedAltitude = (value != null ? +value : null);\n  }\n\n  set updatedAccuracy(value) {\n    this._updatedAccuracy = (value != null ? +value : null);\n  }\n\n  get hasCreatedCoordinate() {\n    return this.createdLatitude != null && this.createdLongitude != null;\n  }\n\n  get hasUpdatedCoordinate() {\n    return this.updatedLatitude != null && this.updatedLongitude != null;\n  }\n\n  get createdLocation() {\n    if (this.hasCreatedCoordinate) {\n      return {\n        latitude: this.createdLatitude,\n        longitude: this.createdLongitude,\n        altitude: this.createdAltitude,\n        horizontal_accuracy: this.createdAccuracy\n      };\n    }\n\n    return null;\n  }\n\n  get updatedLocation() {\n    if (this.hasUpdatedCoordinate) {\n      return {\n        latitude: this.updatedLatitude,\n        longitude: this.updatedLongitude,\n        altitude: this.updatedAltitude,\n        horizontal_accuracy: this.updatedAccuracy\n      };\n    }\n\n    return null;\n  }\n\n  updateFromActionAttributes(attributes, role) {\n    for (const dataName of Object.keys(attributes)) {\n      switch (dataName) {\n        case 'project_id': {\n          if (attributes.project_id && role.canChangeProject) {\n            this.projectID = attributes.project_id;\n          }\n\n          break;\n        }\n\n        case 'assigned_to_id': {\n          if (attributes.assigned_to_id && role.canAssignRecords) {\n            this.assignedToID = attributes.assigned_to_id;\n          }\n\n          break;\n        }\n\n        case 'status': {\n          if (attributes.status && role.canChangeStatus) {\n            this.status = attributes.status;\n          }\n\n          break;\n        }\n\n        case 'latitude': {\n          if (attributes.latitude != null && attributes.latitude >= -90 && attributes.latitude <= 90) {\n            this.latitude = +attributes.latitude;\n          }\n\n          break;\n        }\n\n        case 'longitude': {\n          if (attributes.longitude != null && attributes.longitude >= -180 && attributes.longitude <= 180) {\n            this.longitude = +attributes.longitude;\n          }\n\n          break;\n        }\n\n        default: {\n          const element = this.form.elementsByDataName[dataName];\n          const value = attributes[dataName];\n\n          if (element && value != null) {\n            const formValue = this.formValues.createValueFromString(element, value);\n\n            if (formValue) {\n              this.formValues.set(element.key, formValue);\n            }\n          }\n\n          break;\n        }\n      }\n    }\n  }\n}\n"]}